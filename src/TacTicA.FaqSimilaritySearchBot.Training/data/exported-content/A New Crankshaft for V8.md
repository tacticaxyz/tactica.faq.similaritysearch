URL:https://blog.chromium.org/2010/12/new-crankshaft-for-v8.html
# A New Crankshaft for V8
- **Published**: 2010-12-07T08:28:00.000-08:00
Today we are introducing Crankshaft, a new compilation infrastructure for V8, Google Chrome’s JavaScript engine. By using aggressive optimizations, Crankshaft dramatically improves the performance of compute-intensive JavaScript applications - often by more than a factor of two! This will give users a faster and more responsive experience loading web pages and applications built with complex JavaScript. Here is a comparison of Chrome with and without Crankshaft on the [V8 benchmark suite](http://v8.googlecode.com/svn/data/benchmarks/current/run.html):

[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEghT5ZCiwTYlu5BPR7XPjhARwtsIIkytuFV3Gbo6n0lJNCSrRPrNb1XCjzOkHhsVdkgmaj8uh4aSWi5Z4lzAkQ6loLnoHgNaTUgXT-bAyotIAP_-XuQyXjYNcmvqJ4Kkcdnd6tCOes97-c/s400/graph1.png)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEghT5ZCiwTYlu5BPR7XPjhARwtsIIkytuFV3Gbo6n0lJNCSrRPrNb1XCjzOkHhsVdkgmaj8uh4aSWi5Z4lzAkQ6loLnoHgNaTUgXT-bAyotIAP_-XuQyXjYNcmvqJ4Kkcdnd6tCOes97-c/s1600/graph1.png)

The benchmarks that benefit the most from Crankshaft are Richards, DeltaBlue and Crypto. This shows that we have taken the performance of JavaScript property accesses, arithmetic operations, tight loops, and function calls to the next level. Overall, Crankshaft boosts V8’s performance by 50% on the V8 benchmark suite. This is the biggest performance improvement since we launched Chrome in 2008.

[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEiEYVTIzNpZphsef9063VrMIJmA3ktKjtQ1ZddOC2L_M_ipvMzniDmhznNGCX9dZprqGRWUP6qSQdgJ2Ot-DfLp-ZCcD2uNq8sE_JZLGNoOPWnbrjKCJvVd0pYvAA70hKV3pvSgb9M_AQM/s400/Graph2.png)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEiEYVTIzNpZphsef9063VrMIJmA3ktKjtQ1ZddOC2L_M_ipvMzniDmhznNGCX9dZprqGRWUP6qSQdgJ2Ot-DfLp-ZCcD2uNq8sE_JZLGNoOPWnbrjKCJvVd0pYvAA70hKV3pvSgb9M_AQM/s1600/Graph2.png)

In addition to improving peak performance as measured by the V8 benchmark suite, Crankshaft also improves the start-up time of web applications such as GMail. Our [page cycler](http://www.chromium.org/developers/testing/page-cyclers) benchmarks show that Crankshaft improves the page load performance of Chrome by 12% for pages that contain significant amounts of JavaScript code.  
  
Crankshaft uses adaptive compilation to improve both start-up time and peak performance. The idea is to heavily optimize code that is frequently executed and not waste time optimizing code that is not. Because of this, benchmarks that finish in just a few milliseconds, such as SunSpider, will show little improvement with Crankshaft. The more work an application does, the bigger the gains will be.  
  
Crankshaft has four main components:

1. A **base compiler** which is used for all code initially. The base compiler generates code quickly without heavy optimizations. Compilation with the base compiler is twice as fast as with the V8 compiler in Chrome 9 and generates 30% less code.
2. A **runtime profiler** which monitors the running system and identifies hot code, i.e., code that we spend a significant amount of the time running.
3. An **optimizing compiler** which recompiles and optimizes hot code identified by the runtime profiler. It uses [static single assignment](http://en.wikipedia.org/wiki/Static_single_assignment_form) form to perform optimizations such as [loop-invariant code motion](http://en.wikipedia.org/wiki/Loop-invariant_code_motion), linear-scan [register allocation](http://en.wikipedia.org/wiki/Register_allocation) and [inlining](http://en.wikipedia.org/wiki/Inlining). The optimization decisions are based on type information collected while running the code produced by the base compiler.
4. **Deoptimization support** which allows the optimizing compiler to be optimistic in the assumptions it makes when generating code. With deoptimization support, it is possible to bail out to the code generated by the base compiler if the assumptions in the optimized code turn out to be too optimistic.

V8 with Crankshaft for the 32-bit Intel architecture is available today in the V8 [bleeding edge repository](http://code.google.com/p/v8/) and in [canary builds](http://tools.google.com/dlpage/chromesxs) of Chrome. Work on the ARM and 64-bit ports has started.  
  
We are excited about the JavaScript speed improvements we are delivering with Crankshaft today. Crankshaft provides a great infrastructure for the next wave of JavaScript speed improvements in V8 and we will continue to push JavaScript performance to enable the next generation of web applications.  
  
Kevin Millikin, Software Engineer and Florian Schneider, Software Engineer